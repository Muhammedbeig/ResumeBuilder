ResuPro Phase2 API Response Guide
================================

Collection files
- postman/resupro-phase2-all-apis.postman_collection.json
- postman/resupro-phase2-all-apis.postman_environment.json

What this collection covers
- All Next route handlers under app/api
- All Laravel internal endpoints from /api/internal/*

Before testing
1) Import both files in Postman.
2) Set these environment values:
   - internalExportKey = INTERNAL_EXPORT_KEY from Next .env
   - internalApiKey = RESUPRO_INTERNAL_API_KEY (same in Next + Panel)
   - userEmail/userPassword = existing user credentials
   - packageId = paid package id for payment tests
3) Run auth helper requests first:
   - GET /api/auth/csrf
   - POST /api/auth/callback/credentials?json=true
   - GET /api/auth/session (must return user object)

Common response patterns
- Next APIs:
  - Success: endpoint-specific JSON (or binary for PDF)
  - Error: {"error":"..."}
- Panel internal APIs:
  - Success envelope: {"error":false,"message":"Success","data":{...},"code":...}
  - Error envelope: {"error":true,"message":"...","data":...,"code":...,"details":"..."}

Most important expected statuses
- 200/201: success
- 400: bad input
- 401: unauthorized (missing/invalid session or internal user context)
- 402: plan restriction (AI and some paid features)
- 403: forbidden (wrong internal/export key)
- 404: not found
- 409: payment state conflict (for confirms)
- 422: job URL extraction failed quality check
- 429: rate limit exceeded
- 500/502/503: server/upstream/gateway config issues

Endpoint-specific notes
- /api/generate-pdf:
  - Requires header x-internal-export-key
  - Returns binary PDF on success
- File upload endpoints require selecting file in Postman form-data:
  - /api/extract-pdf-text
  - /api/ai/ats-check
  - /api/bank-transfer/receipt
  - /api/internal/bank-transfer/receipt
- /api/ai/job-url accepts full long links including tracking query params.
- /api/payment/activation-status should return:
  - {status:"pending|active|failed", subscription, subscriptionPlanId}

Recommended run order
1) Next API - auth folder
2) Next API - user/resumes/cvs folders
3) Next API - ai folder
4) Next API - generate-pdf and payment folders
5) Panel Internal APIs folder
